<div class="main-container">
    <div class="tools-container">
        <a mat-icon-button matTooltip="Back" (click)="back()">
            <i class="material-icons">arrow_back</i>
        </a>
        <h2>{{params_id ? 'Edit' : 'Add New'}} {{params_network}}</h2>
    </div>
    
    <div class="container pt10 pl10 pr10 pb50">
        <form #f="ngForm" (ngSubmit)=" f.valid && submitDetail()">
            <div class="row">
                <div class="col s12">
                    <div class="card pb0">
                        <div class="card-head">
                            <h2>Basic Information</h2>
                        </div>
                        <div class="card-body cs-form">
                            <div class="row">
                                  <div class="col s12 m3 l3" *ngIf="params_type != 3" >
                                    <mat-form-field appearance="outline">
                                        <mat-label> {{params_network ? (params_network) : ''}} Name</mat-label>
                                        <!-- pattern="^[A-Za-z? ,_-]+$" -->
                                        <input matInput placeholder="Type Here ..." name="company_name" #company_name="ngModel"   minlength="3"   [(ngModel)]="data.company_name"
                                        required>
                                    </mat-form-field>
                                    <div class="alert alert-danger" *ngIf="company_name.touched || f.submitted">
                                        <p *ngIf="company_name.errors?.required">This field is required</p>
                                        <p *ngIf="company_name.errors?.minlength">Must be at least 3 characters</p>
                                    </div>
                                    
                                    
                                </div>
                                <div class="col s12 m3 l3" *ngIf="params_type != 3">
                                    <mat-form-field appearance="outline" [ngClass]="{'has-error' : name.invalid } ">
                                        <mat-label>Contact Person</mat-label>
                                        <!-- pattern="^[A-Za-z? ,_-]+$" -->
                                        <input matInput placeholder="Type Here ..." name="name" #name="ngModel"   minlength="3"   [(ngModel)]="data.name"
                                        required>
                                    </mat-form-field>
                                    <div class="alert alert-danger" *ngIf="name.touched || f.submitted">
                                        <p *ngIf="name.errors?.required">This field is required</p>
                                        <p *ngIf="name.errors?.minlength">Must be at least 3 characters</p>
                                        <p *ngIf="name.errors?.pattern && (!name.errors?.minlength)">Numerical number and special character not allowed (1234567890!@#$%^&*>.)</p>
                                    </div>
                                    
                                    
                                </div>
                                <div class="col s12 m3 l3">
                                    <mat-form-field appearance="outline" [ngClass]="{'has-error' : mobile_no.invalid } ">
                                        <mat-label>Mobile Number</mat-label>
                                        <input type="text" name="mobile_no" minlength="10" maxlength="10" matInput placeholder=""
                                        #mobile_no="ngModel" [(ngModel)]="data.mobile_no"
                                        onkeypress="return event.charCode>=48 && event.charCode<=57"  pattern="^[6-9][0-9]{0,9}$" required>
                                    </mat-form-field>
                                    <div class="alert alert-danger" *ngIf="mobile_no.touched || f.submitted">
                                        <p *ngIf="mobile_no.errors?.required">This field is required</p>
                                        <p *ngIf="mobile_no.errors?.pattern">This mobile number is invalid</p>
                                        <p *ngIf="mobile_no.errors?.minlength && (!mobile_no.errors?.pattern)">Mobile number should be 10 digit</p>
                                    </div>
                                    <div class="alert alert-danger" *ngIf="exist">
                                        Mobile no. already Exists.
                                    </div>
                                </div>
                      
                                 <div class="col s12 m3 l3" *ngIf="params_network == 'Retailer' " >
                                        <mat-form-field appearance="outline" [ngClass]="{'has-error' : upi_id.invalid } ">
                                            <mat-label>UPI ID</mat-label>
                                            <input type="text" name="upi_id" matInput placeholder="" #upi_id="ngModel"
                                            [(ngModel)]="data.upi_id">
                                        </mat-form-field>
                                           <div class="alert alert-danger" *ngIf="upi_id.touched || f.submitted">
                                        <p *ngIf="upi_id.errors?.required">This field is required</p>
                         
                                    </div>
                                    </div>
                            </div>
                     

                                <div class="row mb0" *ngIf="params_type != 3" >
                                    <div class="col s12 m6 l6">
                                        <div class="row">
                                            <div class="col s12 m6 l6">
                                                <mat-form-field appearance="outline">
                                                    <mat-label>Pincode</mat-label>
                                                    <input matInput type="text" name="pincode" placeholder="Type Here ..." #pincode="ngModel"
                                                    (input)="getaddress(data.pincode)" minlength="6" maxlength="6" [(ngModel)]="data.pincode"
                                                    onkeypress="return event.charCode>=48 && event.charCode<=57" required>
                                                </mat-form-field>
                                                <div class="alert alert-danger" *ngIf="pincode.touched || f.submitted">
                                                    <p *ngIf="pincode.errors?.required">This field is required</p>
                                                </div>
                                            </div>
                                            
                                            <div class="col s12 m6 l6">
                                                <mat-form-field appearance="outline">
                                                    <mat-label>Select State</mat-label>
                                                    <mat-select name="state" [(ngModel)]="data.state" #state="ngModel"
                                                    (selectionChange)="getDistrict(1,'')" required>
                                                    <mat-option>
                                                        <ngx-mat-select-search noEntriesFoundLabel="'no data found'" placeholderLabel="Search.."
                                                        (keyup)="getStateList($event.target.value)"></ngx-mat-select-search>
                                                    </mat-option>
                                                    <mat-option *ngFor="let row of states"
                                                    value="{{row.state_name}}">{{row.state_name}}</mat-option>
                                                </mat-select>
                                            </mat-form-field>                      
                                            <div class="alert alert-danger" *ngIf="state.touched || f.submitted">
                                                <p *ngIf="state.errors?.required">This field is required</p>
                                            </div>
                                            
                                        </div>
                                    </div>
                                    
                                    
                                    
                                    <div class="row">
                                        <div class="col s12 m6 l6" >
                                            <mat-form-field appearance="outline">
                                                <mat-label>Select District</mat-label>
                                                <mat-select name="district" [(ngModel)]="data.district" #district="ngModel"  required>
                                                    <mat-option>
                                                        <ngx-mat-select-search noEntriesFoundLabel="'no data found'" placeholderLabel="Search.."
                                                        (keyup)="getDistrict(1,$event.target.value)"></ngx-mat-select-search>
                                                    </mat-option>
                                                    <mat-option *ngFor="let row of district_list"
                                                    value="{{row.district_name}}">{{row.district_name}}</mat-option>
                                                </mat-select>
                                            </mat-form-field>
                                            <div class="alert alert-danger" *ngIf="district.touched || f.submitted">
                                                <p *ngIf="district.errors?.required">This field is required</p>
                                            </div>
                                        </div>
                                        
                                        <div class="col s12 m6 l6" >
                                            <mat-form-field appearance="outline">
                                                <mat-label>City</mat-label>
                                                <input matInput placeholder="Type here..." name="city" #city="ngModel" [(ngModel)]="data.city"
                                                required>
                                            </mat-form-field>
                                            <div class="alert alert-danger" *ngIf="city.touched || f.submitted">
                                                <p *ngIf="city.errors?.required">This field is required</p>
                                            </div>
                                        </div>
                                        
                                        
                                        
                                    </div>
                                </div>
                                <div class="col s12 m6 l6">
                                    <!-- pattern="^[A-Za-z0-9 ./,]+$" -->
                                    <mat-form-field appearance="outline">
                                        <mat-label>Address</mat-label>
                                        <textarea matInput placeholder="Type Here ..." name="address" #address="ngModel"
                                        [(ngModel)]="data.address" class="h80" required></textarea>
                                    </mat-form-field>
                                    <div class="alert alert-danger" *ngIf="address.touched || f.submitted">
                                        <p *ngIf="address.errors?.required">This field is required</p>
                                        <!-- <p *ngIf="address.errors?.pattern">Special character not allowed</p> -->
                                    </div>
                                </div>
                            </div>
                            
                            
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- <div class="row">
             
                
                <div class="col s12 m6 l6">
                    <div class="card pb0">
                        <div class="card-head">
                            <h2>Bank Detail</h2>
                        </div>
                        <div class="card-body cs-form">
                            <div class="row">
                                <div class="col s12 m6 l6">
                                    <mat-form-field appearance="outline">
                                        <mat-label>Select Redeemption Preference</mat-label>
                                        <mat-select name="user_redeemption_prefrence" #user_redeemption_prefrence="ngModel" [(ngModel)]="data.user_redeemption_prefrence">
                                            <mat-option disabled="">Select </mat-option>
                                            <mat-option *ngIf="login_data.organisation_data.redeemption_prefrence == '0' || login_data.organisation_data.redeemption_prefrence == '2'" value="Bank" >Via Bank</mat-option>
                                            <mat-option *ngIf="login_data.organisation_data.redeemption_prefrence == '1' || login_data.organisation_data.redeemption_prefrence == '2'" value="UPI" >Via UPI </mat-option>
                                        </mat-select>
                                    </mat-form-field>
                                </div>
                            </div>
                            
                            <ng-container *ngIf="data.user_redeemption_prefrence == 'Bank'">
                                <div class="row">
                                    <div class="col s12 m6 l6">
                                        <mat-form-field appearance="outline">
                                            <mat-label>Account Number</mat-label>
                                            <input type="text" onkeypress="return event.charCode>=48 && event.charCode<=57" name="account_no"
                                            matInput placeholder="" #account_no="ngModel" minlength="9" maxlength="18" [(ngModel)]="data.account_no">
                                        </mat-form-field>
                                        
                                        <div class="alert alert-danger" *ngIf="account_no.touched || f.submitted">
                                            <p *ngIf="account_no.errors?.minlength">Account number should be 10 digit</p>
                                        </div>
                                        
                                    </div>
                                    <div class="col s12 m6 l6">
                                        <mat-form-field appearance="outline">
                                            <mat-label>IFSC Code</mat-label>
                                            <input type="text" name="ifsc_code" matInput placeholder="" #ifsc_code="ngModel"
                                            [(ngModel)]="data.ifsc_code"  maxlength="11" pattern="^[A-Z]{4}[0][A-Z0-9]{6}$">
                                        </mat-form-field>
                                        <div class="alert alert-danger" *ngIf="ifsc_code.errors?.pattern">
                                            <p>Invalid IFSC Code</p>
                                        </div>
                                    </div>
                                    
                                </div>
                                
                                <div class="row">
                                    <div class="col s12 m6 l6">
                                        <mat-form-field appearance="outline">
                                            <mat-label>Bank Name</mat-label>
                                            <input type="text" name="bank_name" matInput placeholder="" #bank_name="ngModel"
                                            [(ngModel)]="data.bank_name">
                                        </mat-form-field>
                                        
                                    </div>
                                    <div class="col s12 m6 l6">
                                        <mat-form-field appearance="outline">
                                            <mat-label>Account Holder Name</mat-label>
                                           
                                            <input matInput placeholder="Type Here ..." name="account_holder_name"
                                            #account_holder_name="ngModel" [(ngModel)]="data.account_holder_name" minlength="3"  >
                                        </mat-form-field>
                                        <div class="alert alert-danger" *ngIf="account_holder_name.touched || f.submitted">
                                            <p *ngIf="account_holder_name.errors?.minlength">Must be at least 3 characters</p>
                                            <p *ngIf="account_holder_name.errors?.pattern && (!account_holder_name.errors?.minlength)">Numerical number and special character not allowed (1234567890!@#$%^&*>.)</p>
                                        </div>
                                        
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col s6">
                                        <div class="uploade-image">
                                            <ul>
                                                <li class="add-bg-1 wp100">
                                                    <img src="{{bank_img_id ? uploadurl+data.bank_img : data.bank_img}}" *ngIf="data.bank_img">
                                                    <label class="fix-label">
                                                        <input type="file" (change)="bankImg_Upload($event)" style="display:none;"
                                                        accept=".png, .jpg, .jpeg," multiple required />
                                                        <div class="other">
                                                            <i class="material-icons">cloud_upload</i>
                                                            <p>Upload Cheque/Passbook Image</p>
                                                        </div>
                                                    </label>
                                                </li>
                                            </ul>
                                        </div>
                                    </div>
                                </div>
                            </ng-container>
                            
                            <ng-container *ngIf="data.user_redeemption_prefrence == 'UPI'">
                                <div class="row">
                                    <div class="col s12 m6 l6">
                                        <mat-form-field appearance="outline">
                                            <mat-label>UPI ID</mat-label>
                                            <input type="text" name="upi_id" matInput placeholder="" #upi_id="ngModel"
                                            [(ngModel)]="data.upi_id">
                                        </mat-form-field>
                                    </div>
                                </div>
                            </ng-container>
                            
                         
                        </div>
                    </div>
                </div>
            </div>
            <div class="row" *ngIf="formData.length > 0">
                <div class="col s12">
                    <div class="card pb0">
                        <div class="card-head">
                            <h2>Additional Information</h2>
                        </div>
                        <div class="card-body cs-form">
                            <div class="row col-gap">
                                <ng-container *ngIf="!fomDataloader">
                                    <ng-container *ngFor="let row of formData; let i = index">
                                        <div class="col s12 m3 l3"  *ngIf="row.dependent_flag == 1 ? ((row.dependent_field_name == data.field_type) && (row.dependent_field_value == data.type_name)): true">
                                            <mat-form-field class="cs-input" appearance="outline">
                                                <mat-label>{{ row.field_placeholder ? (row.field_placeholder | titlecase) : '' }}</mat-label>
                                                
                                               
                                                <ng-container *ngIf="row.field_type === 'Dropdown'">
                                                    <mat-select name="{{ row.field_name }}" [(ngModel)]="row.value" #ngModelCtrl="ngModel" [required]="row.is_mandate === 'YES'" (selectionChange)="row.sub_dependent_flag == 1 ? dependentFeilds(row.field_name, row.value) : '';  row.dependent_flag == 1 ? ((row.dependent_field_name != data.field_type) && (row.dependent_field_value != data.type_name) ? row.value = '' : ''): ''">
                                                        <mat-option *ngFor="let option of row.dropdown_option" [value]="option">
                                                            {{ option }}
                                                        </mat-option>
                                                    </mat-select>
                                                </ng-container>
                                                
                                               
                                                <ng-container *ngIf="row.field_type !== 'Dropdown'">
                                                    <input 
                                                    matInput 
                                                    type="{{ row.field_text_type }}" 
                                                    name="{{ row.field_name }}" 
                                                    [(ngModel)]="row.value" 
                                                    #ngModelCtrl="ngModel" 
                                                    [pattern]="row.pattern_validation"
                                                    [minlength]="row.field_min_length" 
                                                    [maxlength]="row.field_max_length" 
                                                    [required]="row.is_mandate === 'YES'">
                                                </ng-container>
                                                
                                               
                                                <ng-container *ngIf="ngModelCtrl?.invalid && (ngModelCtrl?.touched || f.submitted)">
                                                    <mat-hint *ngIf="ngModelCtrl?.errors?.required">This field is required</mat-hint>
                                                </ng-container>
                                            </mat-form-field>
                                        </div>
                                    </ng-container>
                                </ng-container>
                                
                                <ng-container *ngIf="!fomDeploader">
                                    <div class="col s12 m3 l3" *ngFor="let row of dependentformData; let i = index">
                                        <mat-form-field class="cs-input" appearance="outline">
                                            <mat-label>{{ row.field_placeholder ? (row.field_placeholder | titlecase) : '' }}</mat-label>
                                            
                                            
                                            <ng-container *ngIf="row.field_type === 'Dropdown'">
                                                <mat-select name="{{ row.field_name }}" [(ngModel)]="row.value" #ngModelCtrl="ngModel" [required]="row.is_mandate === 'YES'">
                                                    <mat-option *ngFor="let option of row.dropdown_option" [value]="option">
                                                        {{ option }}
                                                    </mat-option>
                                                </mat-select>
                                            </ng-container>
                                            
                                            
                                            <ng-container *ngIf="row.field_type !== 'Dropdown'">
                                                <input 
                                                matInput 
                                                type="{{ row.field_text_type }}" 
                                                name="{{ row.field_name }}" 
                                                [(ngModel)]="row.value" 
                                                #ngModelCtrl="ngModel" 
                                                [pattern]="row.pattern_validation"
                                                [minlength]="row.field_min_length" 
                                                [maxlength]="row.field_max_length" 
                                                [required]="row.is_mandate === 'YES'">
                                            </ng-container>
                                            
                                          
                                            <ng-container *ngIf="ngModelCtrl?.invalid && (ngModelCtrl?.touched || f.submitted)">
                                                <mat-hint *ngIf="ngModelCtrl?.errors?.required">This field is required</mat-hint>
                                            </ng-container>
                                        </mat-form-field>
                                    </div>
                                </ng-container>
                                
                                <div class="grid-box m10" *ngIf="fomDataloader || fomDeploader">
                                    <ng-container *ngIf="fomDataloader">
                                        <div class="sk-box" *ngFor="let row of [].constructor(3)">
                                            &nbsp;
                                        </div>
                                    </ng-container>
                                    <ng-container *ngIf="fomDeploader">
                                        <div class="sk-box" *ngFor="let row of [].constructor(1)">
                                            &nbsp;
                                        </div>
                                    </ng-container>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
            </div> -->
            
            <div class="row">
                <div class="col s12">
                    <div class="text-right">
                        <button [ngClass]="{'loading': savingFlag == true}" mat-raised-button color="accent" type="submit" [disabled]="savingFlag == true">{{savingFlag == true ? 'Saving' : params_id ? 'Update' : 'Save'}}
                        </button>
                    </div>
                </div>
            </div>
        </form>
    </div>
</div>
