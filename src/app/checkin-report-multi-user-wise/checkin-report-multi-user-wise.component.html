<div class="main-container">

  <div class="tools-container">
    <h2>Checkin Details</h2>
    <div class="left-auto df ac flex-gap-10">
      <ng-container *ngIf="filter.date_from">
        <div class="filteDate">
          <span>Date From</span>
          <h3>{{filter?.date_from | date:'dd MMM, yyyy'}}</h3>
        </div>
        <div class="filteDate">
          <span>Date To</span>
          <h3>{{filter?.date_to | date:'dd MMM, yyyy'}}</h3>
        </div>
      </ng-container>
      <button mat-icon-button matTooltip="Refresh" (click)="refresh()">
        <i class="material-icons">refresh</i>
      </button>
      <button mat-icon-button matTooltip="Filter" (click)="openBottomSheet()">
        <i class="material-icons">filter_alt</i>
      </button>

      <div class="pagination" *ngIf="reportData.length > 0">
        <div class="pagination-content">
          Pages
          <span>{{pagenumber}}</span>
          of
          <span>{{total_page}}</span>
        </div>
        <div class="page-nav">

          <button mat-icon-button matTooltip="Older" (click)="pervious()" [disabled]="start == 0 || total_page == 0">
            <i class="material-icons">navigate_before</i>
          </button>
          <button mat-icon-button matTooltip="Newer" (click)="nextPage()" [disabled]="pagenumber == total_page ">
            <i class="material-icons">navigate_next</i>
          </button>
        </div>
      </div>


    </div>
  </div>
  <div class="container container-scroll">
    <div class="cs-table horizontal-scroll">
      <div class="sticky-head">
        <div class="table-head">
          <table>
            <tr>
              <th class="w60">Sr No.</th>
              <th class="w150">State</th>
              <th class="w150">District</th>
              <th class="w120">City</th>
              <th class="w100">CheckIn Date</th>
              <th class="w100">Designation</th>
              <th class="w110">Employee Code</th>
              <th class="w160">Employee Name</th>
              <th class="w100">Checkin Time</th>
              <th class="w120">Checkout Time</th>
              <th class="w120">Time Duration</th>
              <th class="w100">Checkin Type</th>
              <th class="w140">Type Of Customer</th>
              <th class="w200">Company Name</th>
              <th class="w150">Contact Person</th>
              <th class="w100">Contact No.</th>
              <th class="w200">Party Address</th>
              <th class="w250">Remark</th>
              <th class="w150">Topic of Discussion</th>
              <th class="w70">Order</th>
              <th class="w80">Follow Up</th>
              <th class="w70">Document </th>
              <th class="w80">BrandÂ Audit</th>
              <th class="w70">Ticket</th>
             
            </tr>
          </table>
        </div>
      </div>
      <div class="table-container">
        <div class="table-content">
          <table>
            <ng-container *ngIf="!loader">
              <tr *ngFor="let report of reportData; let i=index">
                <td class="w60">{{sr_no+i+1}}</td>
                <td class="w150">{{ report.dr_type_name != 'other' && report.dr_data ?report.dr_data.state : '---'}}</td>
                <td class="w150">{{report.dr_type_name != 'other' && report.dr_data ? report.dr_data.district : '---'}}</td>
                <td class="w120">{{report.dr_type_name != 'other' && report.dr_data ? report.dr_data.city : '---'}}</td>
                <td class="w100">{{(report.activity_date != '0000-00-00')? (report.activity_date | date :'dd MMM yyyy') : ('---')}}</td>
                <td class="w100">{{report.designation ? report.designation : '---'}}</td>
                <td class="w110">{{report.employee_code ? report.employee_code : '---'}}</td>
                <td class="w160">{{report.employee_name ? report.employee_name : '---'}}</td>
                <td class="w100">{{report.visit_start != '0000-00-00 00:00:00' ? (report.visit_start | date:'h:mm a') : 'NA'}}</td>
                <td class="w120">{{report.visit_end != '0000-00-00 00:00:00' ? (report.visit_end | date:'h:mm a') : 'NA'}}</td>
                <td class="w120">{{report.visit_duration ? report.visit_duration: 'NA'}}</td>
                <td class="w100">{{report?.dr_type_name}}</td>
                <td class="w140">{{report?.sub_type}}</td>
                <td class="w200">{{report.dr_name?report.dr_name:'---'}}</td>
                <td class="w150">{{report.dr_data?report.dr_data.name:'---'}}</td>
                <td class="w100">{{report.dr_data?report.dr_data.mobile:'---'}}</td>
                <td class="w200">{{report.dr_data?report.dr_data.address:'---'}}</td>
                <td class="w250">{{report.description?report.description : '---'}}</td>
                <td class="w150">{{report?.checklist}}</td>
                <td class="w70">{{report.order_id == '0'? 'No' : 'Yes'}}</td>
                <td class="w80">{{report.followup_flag == '0'? 'No' : 'Yes'}}</td>
                <td class="w70">{{report.doc_flag == '0'? 'No' : 'Yes'}}</td>
                <td class="w80">{{report.brand_audit_id == '0'? 'No' : 'Yes'}}</td>
                <td class="w70">{{report.support_id == '0'? 'No' : 'Yes'}}</td>
              
              </tr>
            </ng-container>
            <ng-container *ngIf="loader">
              <tr class="sk-loading" *ngFor="let row of [].constructor(10);">
                <td class="w60"><div>&nbsp;</div></td>
                <td class="w150"><div>&nbsp;</div></td>
                <td class="w150"><div>&nbsp;</div></td>
                <td class="w120"><div>&nbsp;</div></td>
                <td class="w100"><div>&nbsp;</div></td>
                <td class="w100"><div>&nbsp;</div></td>
                <td class="w110"><div>&nbsp;</div></td>
                <td class="w160"><div>&nbsp;</div></td>
                <td class="w100"><div>&nbsp;</div></td>
                <td class="w120"><div>&nbsp;</div></td>
                <td class="w120"><div>&nbsp;</div></td>
                <td class="w100"><div>&nbsp;</div></td>
                <td class="w140"><div>&nbsp;</div></td>
                <td class="w200"><div>&nbsp;</div></td>
                <td class="w150"><div>&nbsp;</div></td>
                <td class="w100"><div>&nbsp;</div></td>
                <td class="w200"><div>&nbsp;</div></td>
                <td class="w250"><div>&nbsp;</div></td>
                <td class="w150"><div>&nbsp;</div></td>
                <td class="w70"><div>&nbsp;</div></td>
                <td class="w80"><div>&nbsp;</div></td>
                <td class="w70"><div>&nbsp;</div> </td>
                <td class="w80"><div>&nbsp;</div></td>
                <td class="w70"><div>&nbsp;</div></td>
              
              </tr>
            </ng-container>
          </table>
        </div>
      </div>
      <ng-container *ngIf="reportData.length == 0">
        <app-not-result-found></app-not-result-found>
      </ng-container>
    </div>
  </div>
  <div class="fab-btns">
    <!-- <button mat-menu-item
          *ngIf="reportData?.length > 0">
          <mat-icon>download</mat-icon>
          <span>Download in excel</span>
        </button> -->
    <button mat-fab class="excel" *ngIf="reportData.length > 0"
      (click)="progressService.setCancelReq(false); DownloadExcel();" [ngClass]="{'pulse': fabBtnValue=='excel'}">
      <img src="assets/img/excel.svg">
      Download Excel
    </button>
  </div>
</div>